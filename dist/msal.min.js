/*! msal v0.2.3 2018-11-08 */

'use strict';
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("Msal",[],t):"object"==typeof exports?exports.Msal=t():e.Msal=t()}(window,function(){return function(r){var n={};function o(e){if(n[e])return n[e].exports;var t=n[e]={i:e,l:!1,exports:{}};return r[e].call(t.exports,t,t.exports,o),t.l=!0,t.exports}return o.m=r,o.c=n,o.d=function(e,t,r){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)o.d(r,n,function(e){return t[e]}.bind(null,n));return r},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=0)}({"./node_modules/tslib/tslib.es6.js":
/*!*****************************************!*\
  !*** ./node_modules/tslib/tslib.es6.js ***!
  \*****************************************/
/*! exports provided: __extends, __assign, __rest, __decorate, __param, __metadata, __awaiter, __generator, __exportStar, __values, __read, __spread, __await, __asyncGenerator, __asyncDelegator, __asyncValues */function(e,t,r){"use strict";r.r(t),r.d(t,"__extends",function(){return o}),r.d(t,"__assign",function(){return i}),r.d(t,"__rest",function(){return s}),r.d(t,"__decorate",function(){return a}),r.d(t,"__param",function(){return c}),r.d(t,"__metadata",function(){return u}),r.d(t,"__awaiter",function(){return l}),r.d(t,"__generator",function(){return d}),r.d(t,"__exportStar",function(){return h}),r.d(t,"__values",function(){return p}),r.d(t,"__read",function(){return f}),r.d(t,"__spread",function(){return g}),r.d(t,"__await",function(){return m}),r.d(t,"__asyncGenerator",function(){return y}),r.d(t,"__asyncDelegator",function(){return w}),r.d(t,"__asyncValues",function(){return _});
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};function o(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e};function s(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&(r[n[o]]=e[n[o]])}return r}function a(e,t,r,n){var o,i=arguments.length,s=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;0<=a;a--)(o=e[a])&&(s=(i<3?o(s):3<i?o(t,r,s):o(t,r))||s);return 3<i&&s&&Object.defineProperty(t,r,s),s}function c(r,n){return function(e,t){n(e,t,r)}}function u(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function l(i,s,a,c){return new(a||(a=Promise))(function(e,t){function r(e){try{o(c.next(e))}catch(e){t(e)}}function n(e){try{o(c.throw(e))}catch(e){t(e)}}function o(t){t.done?e(t.value):new a(function(e){e(t.value)}).then(r,n)}o((c=c.apply(i,s||[])).next())})}function d(r,n){var o,i,s,e,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,i&&(s=i[2&t[0]?"return":t[0]?"throw":"next"])&&!(s=s.call(i,t[1])).done)return s;switch(i=0,s&&(t=[0,s.value]),t[0]){case 0:case 1:s=t;break;case 4:return a.label++,{value:t[1],done:!1};case 5:a.label++,i=t[1],t=[0];continue;case 7:t=a.ops.pop(),a.trys.pop();continue;default:if(!(s=0<(s=a.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){a=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3])){a.label=t[1];break}if(6===t[0]&&a.label<s[1]){a.label=s[1],s=t;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(t);break}s[2]&&a.ops.pop(),a.trys.pop();continue}t=n.call(r,a)}catch(e){t=[6,e],i=0}finally{o=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}}function h(e,t){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}function p(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}}function f(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),s=[];try{for(;(void 0===t||0<t--)&&!(n=i.next()).done;)s.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s}function g(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(f(arguments[t]));return e}function m(e){return this instanceof m?(this.v=e,this):new m(e)}function y(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o,i=r.apply(e,t||[]),s=[];return o={},n("next"),n("throw"),n("return"),o[Symbol.asyncIterator]=function(){return this},o;function n(n){i[n]&&(o[n]=function(r){return new Promise(function(e,t){1<s.push([n,r,e,t])||a(n,r)})})}function a(e,t){try{(r=i[e](t)).value instanceof m?Promise.resolve(r.value.v).then(c,u):l(s[0][2],r)}catch(e){l(s[0][3],e)}var r}function c(e){a("next",e)}function u(e){a("throw",e)}function l(e,t){e(t),s.shift(),s.length&&a(s[0][0],s[0][1])}}function w(n){var e,o;return e={},t("next"),t("throw",function(e){throw e}),t("return"),e[Symbol.iterator]=function(){return this},e;function t(t,r){n[t]&&(e[t]=function(e){return(o=!o)?{value:m(n[t](e)),done:"return"===t}:r?r(e):e})}}function _(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator];return t?t.call(e):p(e)}},"./src/AadAuthority.ts":
/*!*****************************!*\
  !*** ./src/AadAuthority.ts ***!
  \*****************************/
/*! no static exports found */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(/*! tslib */"./node_modules/tslib/tslib.es6.js"),o=r(/*! ./Authority */"./src/Authority.ts"),i=r(/*! ./XHRClient */"./src/XHRClient.ts"),s=function(r){function t(e,t){return r.call(this,e,t)||this}return n.__extends(t,r),Object.defineProperty(t.prototype,"AadInstanceDiscoveryEndpointUrl",{get:function(){return t.AadInstanceDiscoveryEndpoint+"?api-version=1.0&authorization_endpoint="+this.CanonicalAuthority+"oauth2/v2.0/authorize"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"AuthorityType",{get:function(){return o.AuthorityType.Aad},enumerable:!0,configurable:!0}),t.prototype.GetOpenIdConfigurationEndpointAsync=function(){var r=this,e=new Promise(function(e,t){return e(r.DefaultOpenIdConfigurationEndpoint)});if(!this.IsValidationEnabled)return e;var t=this.CanonicalAuthorityUrlComponents.HostNameAndPort;return this.IsInTrustedHostList(t)?e:(new i.XhrClient).sendRequestAsync(this.AadInstanceDiscoveryEndpointUrl,"GET",!0).then(function(e){return e.tenant_discovery_endpoint})},t.prototype.IsInTrustedHostList=function(e){return t.TrustedHostList[e.toLowerCase()]},t.AadInstanceDiscoveryEndpoint="https://login.microsoftonline.com/common/discovery/instance",t.TrustedHostList={"login.windows.net":"login.windows.net","login.chinacloudapi.cn":"login.chinacloudapi.cn","login.cloudgovapi.us":"login.cloudgovapi.us","login.microsoftonline.com":"login.microsoftonline.com","login.microsoftonline.de":"login.microsoftonline.de","login.microsoftonline.us":"login.microsoftonline.us"},t}(o.Authority);t.AadAuthority=s},"./src/AccessTokenCacheItem.ts":
/*!*************************************!*\
  !*** ./src/AccessTokenCacheItem.ts ***!
  \*************************************/
/*! no static exports found */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e,t){this.key=e,this.value=t};t.AccessTokenCacheItem=n},"./src/AccessTokenKey.ts":
/*!*******************************!*\
  !*** ./src/AccessTokenKey.ts ***!
  \*******************************/
/*! no static exports found */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(/*! ./Utils */"./src/Utils.ts"),n=function(e,t,r,n,o){this.authority=e,this.clientId=t,this.scopes=r,this.userIdentifier=i.Utils.base64EncodeStringUrlSafe(n)+"."+i.Utils.base64EncodeStringUrlSafe(o)};t.AccessTokenKey=n},"./src/AccessTokenValue.ts":
/*!*********************************!*\
  !*** ./src/AccessTokenValue.ts ***!
  \*********************************/
/*! no static exports found */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e,t,r,n){this.accessToken=e,this.idToken=t,this.expiresIn=r,this.clientInfo=n};t.AccessTokenValue=n},"./src/AuthenticationRequestParameters.ts":
/*!************************************************!*\
  !*** ./src/AuthenticationRequestParameters.ts ***!
  \************************************************/
/*! no static exports found */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r(/*! ./Utils */"./src/Utils.ts"),n=function(){function e(e,t,r,n,o,i){this.authorityInstance=e,this.clientId=t,this.scopes=r,this.responseType=n,this.redirectUri=o,this.correlationId=s.Utils.createNewGuid(),this.state=i&&!s.Utils.isEmpty(i)?s.Utils.createNewGuid()+"|"+i:s.Utils.createNewGuid(),this.nonce=s.Utils.createNewGuid(),this.xClientSku="MSAL.JS",this.xClientVer=s.Utils.getLibraryVersion()}return Object.defineProperty(e.prototype,"authority",{get:function(){return this.authorityInstance.CanonicalAuthority},enumerable:!0,configurable:!0}),e.prototype.createNavigateUrl=function(e){var t=this.createNavigationUrlString(e),r=this.authorityInstance.AuthorizationEndpoint;return r.indexOf("?")<0?r+="?":r+="&",""+r+t.join("&")},e.prototype.createNavigationUrlString=function(e){e||(e=[this.clientId]),-1===e.indexOf(this.clientId)&&e.push(this.clientId);var t=[];return t.push("response_type="+this.responseType),this.translateclientIdUsedInScope(e),t.push("scope="+encodeURIComponent(this.parseScope(e))),t.push("client_id="+encodeURIComponent(this.clientId)),t.push("redirect_uri="+encodeURIComponent(this.redirectUri)),t.push("state="+encodeURIComponent(this.state)),t.push("nonce="+encodeURIComponent(this.nonce)),t.push("client_info=1"),t.push("x-client-SKU="+this.xClientSku),t.push("x-client-Ver="+this.xClientVer),this.extraQueryParameters&&t.push(this.extraQueryParameters),t.push("client-request-id="+encodeURIComponent(this.correlationId)),t},e.prototype.translateclientIdUsedInScope=function(e){var t=e.indexOf(this.clientId);0<=t&&(e.splice(t,1),-1===e.indexOf("openid")&&e.push("openid"),-1===e.indexOf("profile")&&e.push("profile"))},e.prototype.parseScope=function(e){var t="";if(e)for(var r=0;r<e.length;++r)t+=r!==e.length-1?e[r]+" ":e[r];return t},e}();t.AuthenticationRequestParameters=n},"./src/Authority.ts":
/*!**************************!*\
  !*** ./src/Authority.ts ***!
  \**************************/
/*! no static exports found */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=r(/*! ./Utils */"./src/Utils.ts"),i=r(/*! ./ErrorMessage */"./src/ErrorMessage.ts"),s=r(/*! ./XHRClient */"./src/XHRClient.ts");(n=t.AuthorityType||(t.AuthorityType={}))[n.Aad=0]="Aad",n[n.Adfs=1]="Adfs",n[n.B2C=2]="B2C";var a=function(){function e(e,t){this.IsValidationEnabled=t,this.CanonicalAuthority=e,this.validateAsUri()}return Object.defineProperty(e.prototype,"Tenant",{get:function(){return this.CanonicalAuthorityUrlComponents.PathSegments[0]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"AuthorizationEndpoint",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.AuthorizationEndpoint.replace("{tenant}",this.Tenant)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"EndSessionEndpoint",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.EndSessionEndpoint.replace("{tenant}",this.Tenant)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"SelfSignedJwtAudience",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.Issuer.replace("{tenant}",this.Tenant)},enumerable:!0,configurable:!0}),e.prototype.validateResolved=function(){if(!this.tenantDiscoveryResponse)throw"Please call ResolveEndpointsAsync first"},Object.defineProperty(e.prototype,"CanonicalAuthority",{get:function(){return this.canonicalAuthority},set:function(e){this.canonicalAuthority=o.Utils.CanonicalizeUri(e),this.canonicalAuthorityUrlComponents=null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CanonicalAuthorityUrlComponents",{get:function(){return this.canonicalAuthorityUrlComponents||(this.canonicalAuthorityUrlComponents=o.Utils.GetUrlComponents(this.CanonicalAuthority)),this.canonicalAuthorityUrlComponents},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"DefaultOpenIdConfigurationEndpoint",{get:function(){return this.CanonicalAuthority+"v2.0/.well-known/openid-configuration"},enumerable:!0,configurable:!0}),e.prototype.validateAsUri=function(){var e;try{e=this.CanonicalAuthorityUrlComponents}catch(e){throw i.ErrorMessage.invalidAuthorityType}if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw i.ErrorMessage.authorityUriInsecure;if(!e.PathSegments||e.PathSegments.length<1)throw i.ErrorMessage.authorityUriInvalidPath},e.prototype.DiscoverEndpoints=function(e){return(new s.XhrClient).sendRequestAsync(e,"GET",!0).then(function(e){return{AuthorizationEndpoint:e.authorization_endpoint,EndSessionEndpoint:e.end_session_endpoint,Issuer:e.issuer}})},e.prototype.ResolveEndpointsAsync=function(){var t=this,r="";return this.GetOpenIdConfigurationEndpointAsync().then(function(e){return r=e,t.DiscoverEndpoints(r)}).then(function(e){return t.tenantDiscoveryResponse=e,t})},e}();t.Authority=a},"./src/AuthorityFactory.ts":
/*!*********************************!*\
  !*** ./src/AuthorityFactory.ts ***!
  \*********************************/
/*! no static exports found */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(/*! ./Utils */"./src/Utils.ts"),o=r(/*! ./AadAuthority */"./src/AadAuthority.ts"),i=r(/*! ./B2cAuthority */"./src/B2cAuthority.ts"),s=r(/*! ./Authority */"./src/Authority.ts"),a=r(/*! ./ErrorMessage */"./src/ErrorMessage.ts"),c=function(){function r(){}return r.DetectAuthorityFromUrl=function(e){switch(e=n.Utils.CanonicalizeUri(e),n.Utils.GetUrlComponents(e).PathSegments[0]){case"tfp":return s.AuthorityType.B2C;case"adfs":return s.AuthorityType.Adfs;default:return s.AuthorityType.Aad}},r.CreateInstance=function(e,t){switch(r.DetectAuthorityFromUrl(e)){case s.AuthorityType.B2C:return new i.B2cAuthority(e,t);case s.AuthorityType.Aad:return new o.AadAuthority(e,t);default:throw a.ErrorMessage.invalidAuthorityType}},r}();t.AuthorityFactory=c},"./src/B2cAuthority.ts":
/*!*****************************!*\
  !*** ./src/B2cAuthority.ts ***!
  \*****************************/
/*! no static exports found */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(/*! tslib */"./node_modules/tslib/tslib.es6.js"),o=r(/*! ./AadAuthority */"./src/AadAuthority.ts"),s=r(/*! ./Authority */"./src/Authority.ts"),a=r(/*! ./ErrorMessage */"./src/ErrorMessage.ts"),c=r(/*! ./Utils */"./src/Utils.ts"),i=function(i){function e(e,t){var r=i.call(this,e,t)||this,n=c.Utils.GetUrlComponents(e),o=n.PathSegments;if(o.length<3)throw a.ErrorMessage.b2cAuthorityUriInvalidPath;return r.CanonicalAuthority="https://"+n.HostNameAndPort+"/"+o[0]+"/"+o[1]+"/"+o[2]+"/",r}return n.__extends(e,i),Object.defineProperty(e.prototype,"AuthorityType",{get:function(){return s.AuthorityType.B2C},enumerable:!0,configurable:!0}),e.prototype.GetOpenIdConfigurationEndpointAsync=function(){var r=this,e=new Promise(function(e,t){return e(r.DefaultOpenIdConfigurationEndpoint)});return this.IsValidationEnabled?this.IsInTrustedHostList(this.CanonicalAuthorityUrlComponents.HostNameAndPort)?e:new Promise(function(e,t){return t(a.ErrorMessage.unsupportedAuthorityValidation)}):e},e}(o.AadAuthority);t.B2cAuthority=i},"./src/ClientInfo.ts":
/*!***************************!*\
  !*** ./src/ClientInfo.ts ***!
  \***************************/
/*! no static exports found */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(/*! ./Utils */"./src/Utils.ts"),o=function(){function e(e){if(!e||n.Utils.isEmpty(e))return this.uid="",void(this.utid="");try{var t=n.Utils.base64DecodeStringUrlSafe(e),r=JSON.parse(t);r&&(r.hasOwnProperty("uid")&&(this.uid=r.uid),r.hasOwnProperty("utid")&&(this.utid=r.utid))}catch(e){throw new Error(e)}}return Object.defineProperty(e.prototype,"uid",{get:function(){return this._uid?this._uid:""},set:function(e){this._uid=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"utid",{get:function(){return this._utid?this._utid:""},set:function(e){this._utid=e},enumerable:!0,configurable:!0}),e}();t.ClientInfo=o},"./src/Constants.ts":
/*!**************************!*\
  !*** ./src/Constants.ts ***!
  \**************************/
/*! no static exports found */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return Object.defineProperty(e,"errorDescription",{get:function(){return"error_description"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"error",{get:function(){return"error"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"scope",{get:function(){return"scope"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"acquireTokenUser",{get:function(){return"msal.acquireTokenUser"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"clientInfo",{get:function(){return"client_info"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"clientId",{get:function(){return"clientId"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"authority",{get:function(){return"msal.authority"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"idToken",{get:function(){return"id_token"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"accessToken",{get:function(){return"access_token"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"expiresIn",{get:function(){return"expires_in"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"sessionState",{get:function(){return"session_state"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"msalClientInfo",{get:function(){return"msal.client.info"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"msalError",{get:function(){return"msal.error"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"msalErrorDescription",{get:function(){return"msal.error.description"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"msalSessionState",{get:function(){return"msal.session.state"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"tokenKeys",{get:function(){return"msal.token.keys"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"accessTokenKey",{get:function(){return"msal.access.token.key"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"expirationKey",{get:function(){return"msal.expiration.key"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"stateLogin",{get:function(){return"msal.state.login"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"stateAcquireToken",{get:function(){return"msal.state.acquireToken"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"stateRenew",{get:function(){return"msal.state.renew"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"nonceIdToken",{get:function(){return"msal.nonce.idtoken"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"userName",{get:function(){return"msal.username"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"idTokenKey",{get:function(){return"msal.idtoken"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"loginRequest",{get:function(){return"msal.login.request"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"loginError",{get:function(){return"msal.login.error"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"renewStatus",{get:function(){return"msal.token.renew.status"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"msal",{get:function(){return"msal"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"no_user",{get:function(){return"NO_USER"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"login_hint",{get:function(){return"login_hint"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"domain_hint",{get:function(){return"domain_hint"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"sid",{get:function(){return"sid"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"prompt_select_account",{get:function(){return"&prompt=select_account"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"prompt_none",{get:function(){return"&prompt=none"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"response_mode_fragment",{get:function(){return"&response_mode=fragment"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"resourceDelimeter",{get:function(){return"|"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"tokenRenewStatusCancelled",{get:function(){return"Canceled"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"tokenRenewStatusCompleted",{get:function(){return"Completed"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"tokenRenewStatusInProgress",{get:function(){return"In Progress"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"popUpWidth",{get:function(){return this._popUpWidth},set:function(e){this._popUpWidth=e},enumerable:!0,configurable:!0}),Object.defineProperty(e,"popUpHeight",{get:function(){return this._popUpHeight},set:function(e){this._popUpHeight=e},enumerable:!0,configurable:!0}),Object.defineProperty(e,"login",{get:function(){return"LOGIN"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"renewToken",{get:function(){return"RENEW_TOKEN"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"unknown",{get:function(){return"UNKNOWN"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"urlHash",{get:function(){return"msal.urlHash"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"angularLoginRequest",{get:function(){return"msal.angular.login.request"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"userIdentifier",{get:function(){return"userIdentifier"},enumerable:!0,configurable:!0}),e._popUpWidth=483,e._popUpHeight=600,e}();t.Constants=n;var o=function(){function e(){}return Object.defineProperty(e,"loginProgressError",{get:function(){return"login_progress_error"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"acquireTokenProgressError",{get:function(){return"acquiretoken_progress_error"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"inputScopesError",{get:function(){return"input_scopes_error"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"endpointResolutionError",{get:function(){return"endpoints_resolution_error"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"popUpWindowError",{get:function(){return"popup_window_error"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"userLoginError",{get:function(){return"user_login_error"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"userCancelledError",{get:function(){return"user_cancelled"},enumerable:!0,configurable:!0}),e}();t.ErrorCodes=o;var i=function(){function e(){}return Object.defineProperty(e,"loginProgressError",{get:function(){return"Login is in progress"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"acquireTokenProgressError",{get:function(){return"Acquire token is in progress"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"inputScopesError",{get:function(){return"Invalid value of input scopes provided"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"endpointResolutionError",{get:function(){return"Endpoints cannot be resolved"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"popUpWindowError",{get:function(){return"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser."},enumerable:!0,configurable:!0}),Object.defineProperty(e,"userLoginError",{get:function(){return"User login is required"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"userCancelledError",{get:function(){return"User closed the popup window and cancelled the flow"},enumerable:!0,configurable:!0}),e}();t.ErrorDescription=i},"./src/ErrorMessage.ts":
/*!*****************************!*\
  !*** ./src/ErrorMessage.ts ***!
  \*****************************/
/*! no static exports found */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return Object.defineProperty(e,"authorityUriInvalidPath",{get:function(){return"AuthorityUriInvalidPath"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"authorityUriInsecure",{get:function(){return"AuthorityUriInsecure"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"invalidAuthorityType",{get:function(){return"InvalidAuthorityType"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"unsupportedAuthorityValidation",{get:function(){return"UnsupportedAuthorityValidation"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"b2cAuthorityUriInvalidPath",{get:function(){return"B2cAuthorityUriInvalidPath"},enumerable:!0,configurable:!0}),e}();t.ErrorMessage=n},"./src/IdToken.ts":
/*!************************!*\
  !*** ./src/IdToken.ts ***!
  \************************/
/*! no static exports found */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(/*! ./Utils */"./src/Utils.ts"),o=function(e){var t="preferred_username",r="home_oid";if(n.Utils.isEmpty(e))throw new Error("null or empty raw idtoken");try{this.rawIdToken=e,this.decodedIdToken=n.Utils.extractIdToken(e),this.decodedIdToken&&(this.decodedIdToken.hasOwnProperty("iss")&&(this.issuer=this.decodedIdToken.iss),this.decodedIdToken.hasOwnProperty("oid")&&(this.objectId=this.decodedIdToken.oid),this.decodedIdToken.hasOwnProperty("sub")&&(this.subject=this.decodedIdToken.sub),this.decodedIdToken.hasOwnProperty("tid")&&(this.tenantId=this.decodedIdToken.tid),this.decodedIdToken.hasOwnProperty("ver")&&(this.version=this.decodedIdToken.ver),this.decodedIdToken.hasOwnProperty(t)&&(this.preferredName=this.decodedIdToken[t]),this.decodedIdToken.hasOwnProperty("name")&&(this.name=this.decodedIdToken.name),this.decodedIdToken.hasOwnProperty("nonce")&&(this.nonce=this.decodedIdToken.nonce),this.decodedIdToken.hasOwnProperty("exp")&&(this.expiration=this.decodedIdToken.exp),this.decodedIdToken.hasOwnProperty(r)&&(this.homeObjectId=this.decodedIdToken[r]),this.decodedIdToken.hasOwnProperty("sid")&&(this.sid=this.decodedIdToken.sid))}catch(e){throw new Error("Failed to parse the returned id token")}};t.IdToken=o},"./src/Logger.ts":
/*!***********************!*\
  !*** ./src/Logger.ts ***!
  \***********************/
/*! no static exports found */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c,n,i=r(/*! ./Utils */"./src/Utils.ts");(n=c=t.LogLevel||(t.LogLevel={}))[n.Error=0]="Error",n[n.Warning=1]="Warning",n[n.Info=2]="Info",n[n.Verbose=3]="Verbose";var o=function(){function e(e,t){void 0===t&&(t={}),this._level=c.Info;var r=t.correlationId,n=void 0===r?"":r,o=t.level,i=void 0===o?c.Info:o,s=t.piiLoggingEnabled,a=void 0!==s&&s;this._localCallback=e,this._correlationId=n,this._level=i,this._piiLoggingEnabled=a}return e.prototype.logMessage=function(e,t,r){if(!(e>this._level||!this._piiLoggingEnabled&&r)){var n,o=(new Date).toUTCString();n=i.Utils.isEmpty(this._correlationId)?o+":"+i.Utils.getLibraryVersion()+"-"+c[e]+" "+t:o+":"+this._correlationId+"-"+i.Utils.getLibraryVersion()+"-"+c[e]+" "+t,this.executeCallback(e,n,r)}},e.prototype.executeCallback=function(e,t,r){this._localCallback&&this._localCallback(e,t,r)},e.prototype.error=function(e){this.logMessage(c.Error,e,!1)},e.prototype.errorPii=function(e){this.logMessage(c.Error,e,!0)},e.prototype.warning=function(e){this.logMessage(c.Warning,e,!1)},e.prototype.warningPii=function(e){this.logMessage(c.Warning,e,!0)},e.prototype.info=function(e){this.logMessage(c.Info,e,!1)},e.prototype.infoPii=function(e){this.logMessage(c.Info,e,!0)},e.prototype.verbose=function(e){this.logMessage(c.Verbose,e,!1)},e.prototype.verbosePii=function(e){this.logMessage(c.Verbose,e,!0)},e}();t.Logger=o},"./src/RequestInfo.ts":
/*!****************************!*\
  !*** ./src/RequestInfo.ts ***!
  \****************************/
/*! no static exports found */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){this.valid=!1,this.parameters={},this.stateMatch=!1,this.stateResponse="",this.requestType="unknown"};t.TokenResponse=n},"./src/Storage.ts":
/*!************************!*\
  !*** ./src/Storage.ts ***!
  \************************/
/*! no static exports found */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(/*! ./Constants */"./src/Constants.ts"),a=r(/*! ./AccessTokenCacheItem */"./src/AccessTokenCacheItem.ts"),o=function(){function t(e){if(t._instance)return t._instance;if(this._cacheLocation=e,this._localStorageSupported=void 0!==window[this._cacheLocation]&&null!==window[this._cacheLocation],this._sessionStorageSupported=void 0!==window[e]&&null!==window[e],!(t._instance=this)._localStorageSupported&&!this._sessionStorageSupported)throw new Error("localStorage and sessionStorage not supported");return t._instance}return t.prototype.setItem=function(e,t,r){window[this._cacheLocation]&&window[this._cacheLocation].setItem(e,t),r&&this.setItemCookie(e,t)},t.prototype.getItem=function(e,t){return t&&this.getItemCookie(e)?this.getItemCookie(e):window[this._cacheLocation]?window[this._cacheLocation].getItem(e):void 0},t.prototype.removeItem=function(e){if(window[this._cacheLocation])return window[this._cacheLocation].removeItem(e)},t.prototype.clear=function(){if(window[this._cacheLocation])return window[this._cacheLocation].clear()},t.prototype.getAllAccessTokens=function(e,t){var r,n=[],o=window[this._cacheLocation];if(o){var i=void 0;for(i in o)if(o.hasOwnProperty(i)&&i.match(e)&&i.match(t)){var s=this.getItem(i);s&&(r=new a.AccessTokenCacheItem(JSON.parse(i),JSON.parse(s)),n.push(r))}}return n},t.prototype.removeAcquireTokenEntries=function(e,t){var r=window[this._cacheLocation];if(r){var n=void 0;for(n in r)r.hasOwnProperty(n)&&(""!==e&&-1<n.indexOf(e)||""!==t&&-1<n.indexOf(t))&&this.removeItem(n)}},t.prototype.resetCacheItems=function(){var e=window[this._cacheLocation];if(e){var t=void 0;for(t in e)e.hasOwnProperty(t)&&-1!==t.indexOf(n.Constants.msal)&&this.setItem(t,""),e.hasOwnProperty(t)&&-1!==t.indexOf(n.Constants.renewStatus)&&this.removeItem(t)}},t.prototype.setItemCookie=function(e,t,r){var n=e+"="+t+";";r&&(n+="expires="+this.setExpirationCookie(r)+";");document.cookie=n},t.prototype.getItemCookie=function(e){for(var t=e+"=",r=document.cookie.split(";"),n=0;n<r.length;n++){for(var o=r[n];" "===o.charAt(0);)o=o.substring(1);if(0===o.indexOf(t))return o.substring(t.length,o.length)}return""},t.prototype.setExpirationCookie=function(e){var t=new Date;return new Date(t.getTime()+24*e*60*60*1e3).toUTCString()},t.prototype.clearCookie=function(){this.setItemCookie(n.Constants.nonceIdToken,"",-1),this.setItemCookie(n.Constants.stateLogin,"",-1),this.setItemCookie(n.Constants.loginRequest,"",-1),this.setItemCookie(n.Constants.stateAcquireToken,"",-1)},t}();t.Storage=o},"./src/User.ts":
/*!*********************!*\
  !*** ./src/User.ts ***!
  \*********************/
/*! no static exports found */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(/*! ./Utils */"./src/Utils.ts"),n=function(){function s(e,t,r,n,o,i){this.displayableId=e,this.name=t,this.identityProvider=r,this.userIdentifier=n,this.idToken=o,this.sid=i}return s.createUser=function(e,t,r){var n,o;o=t?(n=t.uid,t.utid):n="";var i=a.Utils.base64EncodeStringUrlSafe(n)+"."+a.Utils.base64EncodeStringUrlSafe(o);return new s(e.preferredName,e.name,e.issuer,i,e.decodedIdToken,e.sid)},s}();t.User=n},"./src/UserAgentApplication.ts":
/*!*************************************!*\
  !*** ./src/UserAgentApplication.ts ***!
  \*************************************/
/*! no static exports found */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(/*! tslib */"./node_modules/tslib/tslib.es6.js"),f=r(/*! ./AccessTokenKey */"./src/AccessTokenKey.ts"),g=r(/*! ./AccessTokenValue */"./src/AccessTokenValue.ts"),p=r(/*! ./AuthenticationRequestParameters */"./src/AuthenticationRequestParameters.ts"),m=r(/*! ./ClientInfo */"./src/ClientInfo.ts"),O=r(/*! ./Constants */"./src/Constants.ts"),h=r(/*! ./IdToken */"./src/IdToken.ts"),R=r(/*! ./Logger */"./src/Logger.ts"),x=r(/*! ./Storage */"./src/Storage.ts"),s=r(/*! ./RequestInfo */"./src/RequestInfo.ts"),y=r(/*! ./User */"./src/User.ts"),w=r(/*! ./Utils */"./src/Utils.ts"),_=r(/*! ./AuthorityFactory */"./src/AuthorityFactory.ts"),C="id_token",v="token",I="id_token token",o=function(e,t,r){var n=r.value;return r.value=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.isInIframe()?new Promise(function(){}):n.apply(this,e)},r},i=function(){function e(e,t,r,n){void 0===n&&(n={}),this._cacheLocations={localStorage:"localStorage",sessionStorage:"sessionStorage"},this._clockSkew=300,this._tokenReceivedCallback=null,this._isAngular=!1;var o=n.validateAuthority,i=void 0===o||o,s=n.cacheLocation,a=void 0===s?"sessionStorage":s,c=n.redirectUri,u=void 0===c?window.location.href.split("?")[0].split("#")[0]:c,l=n.postLogoutRedirectUri,d=void 0===l?window.location.href.split("?")[0].split("#")[0]:l,h=n.logger,p=void 0===h?new R.Logger(null):h,f=n.loadFrameTimeout,g=void 0===f?6e3:f,m=n.navigateToLoginRequestUrl,y=void 0===m||m,w=n.state,_=void 0===w?"":w,C=n.isAngular,v=void 0!==C&&C,I=n.unprotectedResources,b=void 0===I?new Array:I,k=n.protectedResourceMap,S=void 0===k?new Map:k,T=n.storeAuthStateInCookie,P=void 0!==T&&T;if(this.loadFrameTimeout=g,this.clientId=e,this.validateAuthority=i,this.authority=t||"https://login.microsoftonline.com/common",this._tokenReceivedCallback=r,this._redirectUri=u,this._postLogoutredirectUri=d,this._loginInProgress=!1,this._acquireTokenInProgress=!1,this._cacheLocation=a,this._navigateToLoginRequestUrl=y,this._state=_,this._isAngular=v,this._unprotectedResources=b,this._protectedResourceMap=S,!this._cacheLocations[a])throw new Error("Cache Location is not valid. Provided value:"+this._cacheLocation+".Possible values are: "+this._cacheLocations.localStorage+", "+this._cacheLocations.sessionStorage);this._cacheStorage=new x.Storage(this._cacheLocation),this._logger=p,this.storeAuthStateInCookie=P,window.openedWindows=[],window.activeRenewals={},window.renewStates=[],window.callBackMappedToRenewStates={},window.callBacksMappedToRenewStates={},window.msal=this;var U=window.location.hash,A=this.isCallback(U);if(!this._isAngular)if(A)this.handleAuthenticationResponse.call(this,U);else{var E=this._cacheStorage.getItem(O.Constants.urlHash);E&&this.processCallBack(E)}}return Object.defineProperty(e.prototype,"cacheLocation",{get:function(){return this._cacheLocation},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"authority",{get:function(){return this.authorityInstance.CanonicalAuthority},set:function(e){this.authorityInstance=_.AuthorityFactory.CreateInstance(e,this.validateAuthority)},enumerable:!0,configurable:!0}),e.prototype.processCallBack=function(e){this._logger.info("Processing the callback from redirect response");var t=this.getRequestInfo(e);this.saveTokenFromHash(t);var r,n=t.parameters[O.Constants.accessToken]||t.parameters[O.Constants.idToken],o=t.parameters[O.Constants.errorDescription],i=t.parameters[O.Constants.error];r=t.parameters[O.Constants.accessToken]?O.Constants.accessToken:O.Constants.idToken,this._cacheStorage.removeItem(O.Constants.urlHash);try{this._tokenReceivedCallback&&(this._cacheStorage.clearCookie(),this._tokenReceivedCallback.call(this,o,n,i,r,this.getUserState(this._cacheStorage.getItem(O.Constants.stateLogin,this.storeAuthStateInCookie))))}catch(e){this._logger.error("Error occurred in token received callback function: "+e)}},e.prototype.loginRedirect=function(o,i){var s=this;if(this._loginInProgress&&this._tokenReceivedCallback)this._tokenReceivedCallback(O.ErrorDescription.loginProgressError,null,O.ErrorCodes.loginProgressError,O.Constants.idToken,this.getUserState(this._cacheStorage.getItem(O.Constants.stateLogin,this.storeAuthStateInCookie)));else{if(o){var e=this.validateInputScope(o);if(e&&!w.Utils.isEmpty(e)&&this._tokenReceivedCallback)return void this._tokenReceivedCallback(O.ErrorDescription.inputScopesError,null,O.ErrorCodes.inputScopesError,O.Constants.idToken,this.getUserState(this._cacheStorage.getItem(O.Constants.stateLogin,this.storeAuthStateInCookie)));o=this.filterScopes(o)}this._loginInProgress=!0,this.authorityInstance.ResolveEndpointsAsync().then(function(){var e=new p.AuthenticationRequestParameters(s.authorityInstance,s.clientId,o,C,s._redirectUri,s._state);i&&(e.extraQueryParameters=i);var t=s._cacheStorage.getItem(O.Constants.angularLoginRequest);t&&""!==t?s._cacheStorage.setItem(O.Constants.angularLoginRequest,""):t=window.location.href,s._cacheStorage.setItem(O.Constants.loginRequest,t,s.storeAuthStateInCookie),s._cacheStorage.setItem(O.Constants.loginError,""),s._cacheStorage.setItem(O.Constants.stateLogin,e.state,s.storeAuthStateInCookie),s._cacheStorage.setItem(O.Constants.nonceIdToken,e.nonce,s.storeAuthStateInCookie),s._cacheStorage.setItem(O.Constants.msalError,""),s._cacheStorage.setItem(O.Constants.msalErrorDescription,"");var r=O.Constants.authority+O.Constants.resourceDelimeter+e.state;w.Utils.isEmpty(s._cacheStorage.getItem(r))&&s._cacheStorage.setItem(r,s.authority);var n=e.createNavigateUrl(o)+O.Constants.prompt_select_account+O.Constants.response_mode_fragment;s.promptUser(n)})}},e.prototype.loginPopup=function(a,c){var u=this;return new Promise(function(n,o){if(u._loginInProgress)o(O.ErrorCodes.loginProgressError+O.Constants.resourceDelimeter+O.ErrorDescription.loginProgressError);else{if(a){var e=u.validateInputScope(a);if(e&&!w.Utils.isEmpty(e))return void o(O.ErrorCodes.inputScopesError+O.Constants.resourceDelimeter+O.ErrorDescription.inputScopesError);a=u.filterScopes(a)}else a=[u.clientId];var i=a.join(" ").toLowerCase(),s=u.openWindow("about:blank","_blank",1,u,n,o);s&&(u._loginInProgress=!0,u.authorityInstance.ResolveEndpointsAsync().then(function(){var e=new p.AuthenticationRequestParameters(u.authorityInstance,u.clientId,a,C,u._redirectUri,u._state);c&&(e.extraQueryParameters=c),u._cacheStorage.setItem(O.Constants.loginRequest,window.location.href,u.storeAuthStateInCookie),u._cacheStorage.setItem(O.Constants.loginError,""),u._cacheStorage.setItem(O.Constants.nonceIdToken,e.nonce,u.storeAuthStateInCookie),u._cacheStorage.setItem(O.Constants.msalError,""),u._cacheStorage.setItem(O.Constants.msalErrorDescription,"");var t=O.Constants.authority+O.Constants.resourceDelimeter+e.state;w.Utils.isEmpty(u._cacheStorage.getItem(t))&&u._cacheStorage.setItem(t,u.authority);var r=e.createNavigateUrl(a)+O.Constants.prompt_select_account+O.Constants.response_mode_fragment;window.renewStates.push(e.state),window.requestType=O.Constants.login,u.registerCallback(e.state,i,n,o),s&&(u._logger.infoPii("Navigated Popup window to:"+r),s.location.href=r)},function(){u._logger.info(O.ErrorCodes.endpointResolutionError+":"+O.ErrorDescription.endpointResolutionError),u._cacheStorage.setItem(O.Constants.msalError,O.ErrorCodes.endpointResolutionError),u._cacheStorage.setItem(O.Constants.msalErrorDescription,O.ErrorDescription.endpointResolutionError),o&&o(O.ErrorCodes.endpointResolutionError+":"+O.ErrorDescription.endpointResolutionError),s&&s.close()}).catch(function(e){u._logger.warning("could not resolve endpoints"),o(e)}))}})},e.prototype.promptUser=function(e){e&&!w.Utils.isEmpty(e)?(this._logger.infoPii("Navigate to:"+e),window.location.replace(e)):this._logger.info("Navigate url is empty")},e.prototype.openWindow=function(e,t,r,n,o,i){var s=this,a=this.openPopup(e,t,O.Constants.popUpWidth,O.Constants.popUpHeight);if(null==a)return n._loginInProgress=!1,n._acquireTokenInProgress=!1,this._logger.info(O.ErrorCodes.popUpWindowError+":"+O.ErrorDescription.popUpWindowError),this._cacheStorage.setItem(O.Constants.msalError,O.ErrorCodes.popUpWindowError),this._cacheStorage.setItem(O.Constants.msalErrorDescription,O.ErrorDescription.popUpWindowError),i&&i(O.ErrorCodes.popUpWindowError+O.Constants.resourceDelimeter+O.ErrorDescription.popUpWindowError),null;window.openedWindows.push(a);var c=window.setInterval(function(){if(a&&a.closed&&n._loginInProgress){if(i&&i(O.ErrorCodes.userCancelledError+O.Constants.resourceDelimeter+O.ErrorDescription.userCancelledError),window.clearInterval(c),s._isAngular)return void s.broadcast("msal:popUpClosed",O.ErrorCodes.userCancelledError+O.Constants.resourceDelimeter+O.ErrorDescription.userCancelledError);n._loginInProgress=!1,n._acquireTokenInProgress=!1}try{var e=a.location;if(-1!==e.href.indexOf(s._redirectUri)&&(window.clearInterval(c),n._loginInProgress=!1,n._acquireTokenInProgress=!1,s._logger.info("Closing popup window"),s._isAngular)){s.broadcast("msal:popUpHashChanged",e.hash);for(var t=0;t<window.openedWindows.length;t++)window.openedWindows[t].close()}}catch(e){}},r);return a},e.prototype.broadcast=function(e,t){var r=new CustomEvent(e,{detail:t});window.dispatchEvent(r)},e.prototype.logout=function(){this.clearCache(),this._user=null;var e="";this._postLogoutredirectUri&&(e="post_logout_redirect_uri="+encodeURIComponent(this._postLogoutredirectUri));var t=this.authority+"/oauth2/v2.0/logout?"+e;this.promptUser(t)},e.prototype.clearCache=function(){window.renewStates=[];for(var e=this._cacheStorage.getAllAccessTokens(O.Constants.clientId,O.Constants.userIdentifier),t=0;t<e.length;t++)this._cacheStorage.removeItem(JSON.stringify(e[t].key));this._cacheStorage.resetCacheItems(),this._cacheStorage.clearCookie()},e.prototype.clearCacheForScope=function(e){for(var t=this._cacheStorage.getAllAccessTokens(O.Constants.clientId,O.Constants.userIdentifier),r=0;r<t.length;r++){var n=t[r];n.value.accessToken===e&&this._cacheStorage.removeItem(JSON.stringify(n.key))}},e.prototype.openPopup=function(e,t,r,n){try{var o=window.screenLeft?window.screenLeft:window.screenX,i=window.screenTop?window.screenTop:window.screenY,s=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,a=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,c=s/2-r/2+o,u=a/2-n/2+i,l=window.open(e,t,"width="+r+", height="+n+", top="+u+", left="+c);return l.focus&&l.focus(),l}catch(e){return this._logger.error("error opening popup "+e.message),this._loginInProgress=!1,this._acquireTokenInProgress=!1,null}},e.prototype.validateInputScope=function(e){if(!e||e.length<1)return"Scopes cannot be passed as an empty array";if(!Array.isArray(e))throw new Error("API does not accept non-array scopes");return-1<e.indexOf(this.clientId)&&1<e.length?"ClientId can only be provided as a single scope":""},e.prototype.filterScopes=function(e){return e=(e=e.filter(function(e){return"openid"!==e})).filter(function(e){return"profile"!==e})},e.prototype.registerCallback=function(i,s,e,t){var a=this;window.activeRenewals[s]=i,window.callBacksMappedToRenewStates[i]||(window.callBacksMappedToRenewStates[i]=[]),window.callBacksMappedToRenewStates[i].push({resolve:e,reject:t}),window.callBackMappedToRenewStates[i]||(window.callBackMappedToRenewStates[i]=function(e,t,r,n){window.activeRenewals[s]=null;for(var o=0;o<window.callBacksMappedToRenewStates[i].length;++o)try{e||r?window.callBacksMappedToRenewStates[i][o].reject(e+O.Constants.resourceDelimeter+r):t&&window.callBacksMappedToRenewStates[i][o].resolve(t)}catch(e){a._logger.warning(e)}window.callBacksMappedToRenewStates[i]=null,window.callBackMappedToRenewStates[i]=null})},e.prototype.getCachedTokenInternal=function(e,t){var r=t||this.getUser();if(r){var n,o=this.authorityInstance?this.authorityInstance:_.AuthorityFactory.CreateInstance(this.authority,this.validateAuthority);return n=w.Utils.compareObjects(r,this.getUser())?-1<e.indexOf(this.clientId)?new p.AuthenticationRequestParameters(o,this.clientId,e,C,this._redirectUri,this._state):new p.AuthenticationRequestParameters(o,this.clientId,e,v,this._redirectUri,this._state):new p.AuthenticationRequestParameters(o,this.clientId,e,I,this._redirectUri,this._state),this.getCachedToken(n,t)}},e.prototype.getCachedToken=function(e,t){var r=null,n=e.scopes,o=this._cacheStorage.getAllAccessTokens(this.clientId,t?t.userIdentifier:null);if(0===o.length)return null;var i=[];if(e.authority){for(s=0;s<o.length;s++){c=(a=o[s]).key.scopes.split(" ");w.Utils.containsScope(c,n)&&a.key.authority===e.authority&&i.push(a)}if(0===i.length)return null;if(1!==i.length)return{errorDesc:"The cache contains multiple tokens satisfying the requirements.Call AcquireToken again providing more requirements like authority",token:null,error:"multiple_matching_tokens_detected"};r=i[0]}else{for(var s=0;s<o.length;s++){var a,c=(a=o[s]).key.scopes.split(" ");w.Utils.containsScope(c,n)&&i.push(a)}if(1===i.length)r=i[0],e.authorityInstance=_.AuthorityFactory.CreateInstance(r.key.authority,this.validateAuthority);else{if(1<i.length)return{errorDesc:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements like authority",token:null,error:"multiple_matching_tokens_detected"};var u=this.getUniqueAuthority(o,"authority");if(1<u.length)return{errorDesc:"Multiple authorities found in the cache. Pass authority in the API overload.",token:null,error:"multiple_matching_tokens_detected"};e.authorityInstance=_.AuthorityFactory.CreateInstance(u[0],this.validateAuthority)}}if(null==r)return null;var l=Number(r.value.expiresIn),d=this._clockSkew||300;return l&&l>w.Utils.now()+d?{errorDesc:null,token:r.value.accessToken,error:null}:(this._cacheStorage.removeItem(JSON.stringify(i[0].key)),null)},e.prototype.getAllUsers=function(){for(var e=[],t=this._cacheStorage.getAllAccessTokens(O.Constants.clientId,O.Constants.userIdentifier),r=0;r<t.length;r++){var n=new h.IdToken(t[r].value.idToken),o=new m.ClientInfo(t[r].value.clientInfo),i=y.User.createUser(n,o,this.authority);e.push(i)}return this.getUniqueUsers(e)},e.prototype.getUniqueUsers=function(e){if(!e||e.length<=1)return e;for(var t=[],r=[],n=0;n<e.length;++n)e[n].userIdentifier&&-1===t.indexOf(e[n].userIdentifier)&&(t.push(e[n].userIdentifier),r.push(e[n]));return r},e.prototype.getUniqueAuthority=function(e,t){var r=[],n=[];return e.forEach(function(e){e.key.hasOwnProperty(t)&&-1===n.indexOf(e.key[t])&&(n.push(e.key[t]),r.push(e.key[t]))}),r},e.prototype.addHintParameters=function(e,t){var r=t||this.getUser();if(r){var n=r.userIdentifier.split("."),o=w.Utils.base64DecodeStringUrlSafe(n[0]),i=w.Utils.base64DecodeStringUrlSafe(n[1]);r.sid&&-1!==e.indexOf(O.Constants.prompt_none)?this.urlContainsQueryStringParameter(O.Constants.sid,e)||this.urlContainsQueryStringParameter(O.Constants.login_hint,e)||(e+="&"+O.Constants.sid+"="+encodeURIComponent(this._user.sid)):this.urlContainsQueryStringParameter(O.Constants.login_hint,e)||!r.displayableId||w.Utils.isEmpty(r.displayableId)||(e+="&"+O.Constants.login_hint+"="+encodeURIComponent(t.displayableId)),w.Utils.isEmpty(o)||w.Utils.isEmpty(i)||(this.urlContainsQueryStringParameter("domain_req",e)||w.Utils.isEmpty(i)||(e+="&domain_req="+encodeURIComponent(i)),this.urlContainsQueryStringParameter("login_req",e)||w.Utils.isEmpty(o)||(e+="&login_req="+encodeURIComponent(o))),this.urlContainsQueryStringParameter(O.Constants.domain_hint,e)||w.Utils.isEmpty(i)||(e+="9188040d-6c67-4c5b-b112-36a304b66dad"===i?"&"+O.Constants.domain_hint+"="+encodeURIComponent("consumers"):"&"+O.Constants.domain_hint+"="+encodeURIComponent("organizations"))}return e},e.prototype.urlContainsQueryStringParameter=function(e,t){return new RegExp("[\\?&]"+e+"=").test(t)},e.prototype.acquireTokenRedirect=function(n,e,t,o){var i=this,r=this.validateInputScope(n);if(r&&!w.Utils.isEmpty(r)&&this._tokenReceivedCallback)this._tokenReceivedCallback(O.ErrorDescription.inputScopesError,null,O.ErrorCodes.inputScopesError,O.Constants.accessToken,this.getUserState(this._cacheStorage.getItem(O.Constants.stateLogin,this.storeAuthStateInCookie)));else{n&&(n=this.filterScopes(n));var s=t||this.getUser();if(!this._acquireTokenInProgress){var a;n.join(" ").toLowerCase();if(!(s||o&&-1!==o.indexOf(O.Constants.login_hint))&&this._tokenReceivedCallback)return this._logger.info("User login is required"),void this._tokenReceivedCallback(O.ErrorDescription.userLoginError,null,O.ErrorCodes.userLoginError,O.Constants.accessToken,this.getUserState(this._cacheStorage.getItem(O.Constants.stateLogin,this.storeAuthStateInCookie)));this._acquireTokenInProgress=!0;var c=e?_.AuthorityFactory.CreateInstance(e,this.validateAuthority):this.authorityInstance;c.ResolveEndpointsAsync().then(function(){var e;a=w.Utils.compareObjects(s,i.getUser())?-1<n.indexOf(i.clientId)?new p.AuthenticationRequestParameters(c,i.clientId,n,C,i._redirectUri,i._state):new p.AuthenticationRequestParameters(c,i.clientId,n,v,i._redirectUri,i._state):new p.AuthenticationRequestParameters(c,i.clientId,n,I,i._redirectUri,i._state),i._cacheStorage.setItem(O.Constants.nonceIdToken,a.nonce,i.storeAuthStateInCookie),e=s?O.Constants.acquireTokenUser+O.Constants.resourceDelimeter+s.userIdentifier+O.Constants.resourceDelimeter+a.state:O.Constants.acquireTokenUser+O.Constants.resourceDelimeter+O.Constants.no_user+O.Constants.resourceDelimeter+a.state,w.Utils.isEmpty(i._cacheStorage.getItem(e))&&i._cacheStorage.setItem(e,JSON.stringify(s));var t=O.Constants.authority+O.Constants.resourceDelimeter+a.state;w.Utils.isEmpty(i._cacheStorage.getItem(t))&&i._cacheStorage.setItem(t,c.CanonicalAuthority),o&&(a.extraQueryParameters=o);var r=a.createNavigateUrl(n)+O.Constants.prompt_select_account+O.Constants.response_mode_fragment;(r=i.addHintParameters(r,s))&&(i._cacheStorage.setItem(O.Constants.stateAcquireToken,a.state,i.storeAuthStateInCookie),window.location.replace(r))})}}},e.prototype.acquireTokenPopup=function(l,t,r,d){var h=this;return new Promise(function(n,o){var e=h.validateInputScope(l);e&&!w.Utils.isEmpty(e)&&o(O.ErrorCodes.inputScopesError+O.Constants.resourceDelimeter+e),l&&(l=h.filterScopes(l));var i=r||h.getUser();if(h._acquireTokenInProgress)o(O.ErrorCodes.acquireTokenProgressError+O.Constants.resourceDelimeter+O.ErrorDescription.acquireTokenProgressError);else{var s,a=l.join(" ").toLowerCase();if(!(i||d&&-1!==d.indexOf(O.Constants.login_hint)))return h._logger.info("User login is required"),void o(O.ErrorCodes.userLoginError+O.Constants.resourceDelimeter+O.ErrorDescription.userLoginError);h._acquireTokenInProgress=!0;var c=t?_.AuthorityFactory.CreateInstance(t,h.validateAuthority):h.authorityInstance,u=h.openWindow("about:blank","_blank",1,h,n,o);u&&c.ResolveEndpointsAsync().then(function(){var e;s=w.Utils.compareObjects(i,h.getUser())?-1<l.indexOf(h.clientId)?new p.AuthenticationRequestParameters(c,h.clientId,l,C,h._redirectUri,h._state):new p.AuthenticationRequestParameters(c,h.clientId,l,v,h._redirectUri,h._state):new p.AuthenticationRequestParameters(c,h.clientId,l,I,h._redirectUri,h._state),h._cacheStorage.setItem(O.Constants.nonceIdToken,s.nonce),s.state=s.state,e=i?O.Constants.acquireTokenUser+O.Constants.resourceDelimeter+i.userIdentifier+O.Constants.resourceDelimeter+s.state:O.Constants.acquireTokenUser+O.Constants.resourceDelimeter+O.Constants.no_user+O.Constants.resourceDelimeter+s.state,w.Utils.isEmpty(h._cacheStorage.getItem(e))&&h._cacheStorage.setItem(e,JSON.stringify(i));var t=O.Constants.authority+O.Constants.resourceDelimeter+s.state;w.Utils.isEmpty(h._cacheStorage.getItem(t))&&h._cacheStorage.setItem(t,c.CanonicalAuthority),d&&(s.extraQueryParameters=d);var r=s.createNavigateUrl(l)+O.Constants.prompt_select_account+O.Constants.response_mode_fragment;r=h.addHintParameters(r,i),window.renewStates.push(s.state),window.requestType=O.Constants.renewToken,h.registerCallback(s.state,a,n,o),u&&(u.location.href=r)},function(){h._logger.info(O.ErrorCodes.endpointResolutionError+":"+O.ErrorDescription.endpointResolutionError),h._cacheStorage.setItem(O.Constants.msalError,O.ErrorCodes.endpointResolutionError),h._cacheStorage.setItem(O.Constants.msalErrorDescription,O.ErrorDescription.endpointResolutionError),o&&o(O.ErrorCodes.endpointResolutionError+O.Constants.resourceDelimeter+O.ErrorDescription.endpointResolutionError),u&&u.close()}).catch(function(e){h._logger.warning("could not resolve endpoints"),o(e)})}})},e.prototype.acquireTokenSilent=function(c,u,l,d){var h=this;return new Promise(function(e,t){var r=h.validateInputScope(c);if(!r||w.Utils.isEmpty(r)){c&&(c=h.filterScopes(c));var n,o=c.join(" ").toLowerCase(),i=l||h.getUser();if(!i&&(!d||-1===d.indexOf(O.Constants.login_hint)&&-1===d.indexOf(O.Constants.sid)))return h._logger.info("User login is required"),void t(O.ErrorCodes.userLoginError+O.Constants.resourceDelimeter+O.ErrorDescription.userLoginError);var s=u?_.AuthorityFactory.CreateInstance(u,h.validateAuthority):h.authorityInstance;n=w.Utils.compareObjects(i,h.getUser())?-1<c.indexOf(h.clientId)?new p.AuthenticationRequestParameters(s,h.clientId,c,C,h._redirectUri,h._state):new p.AuthenticationRequestParameters(s,h.clientId,c,v,h._redirectUri,h._state):new p.AuthenticationRequestParameters(s,h.clientId,c,I,h._redirectUri,h._state);var a=h.getCachedToken(n,i);if(a){if(a.token)return h._logger.info("Token is already in cache for scope:"+o),void e(a.token);if(a.errorDesc||a.error)return h._logger.infoPii(a.errorDesc+":"+a.error),void t(a.errorDesc+O.Constants.resourceDelimeter+a.error)}else h._logger.verbose("Token is not in cache for scope:"+o);return s.ResolveEndpointsAsync().then(function(){window.activeRenewals[o]?(h._logger.verbose("Renew token for scope: "+o+" is in progress. Registering callback"),h.registerCallback(window.activeRenewals[o],o,e,t)):c&&-1<c.indexOf(h.clientId)&&1===c.length?(h._logger.verbose("renewing idToken"),h.renewIdToken(c,e,t,i,n,d)):(h._logger.verbose("renewing accesstoken"),h.renewToken(c,e,t,i,n,d))}).catch(function(e){h._logger.warning("could not resolve endpoints"),t(e)})}t(O.ErrorCodes.inputScopesError+"|"+r)})},e.prototype.loadIframeTimeout=function(e,t,r){var n=this,o=window.activeRenewals[r];this._logger.verbose("Set loading state to pending for: "+r+":"+o),this._cacheStorage.setItem(O.Constants.renewStatus+o,O.Constants.tokenRenewStatusInProgress),this.loadFrame(e,t),setTimeout(function(){n._cacheStorage.getItem(O.Constants.renewStatus+o)===O.Constants.tokenRenewStatusInProgress&&(n._logger.verbose("Loading frame has timed out after: "+n.loadFrameTimeout/1e3+" seconds for scope "+r+":"+o),o&&window.callBackMappedToRenewStates[o]&&window.callBackMappedToRenewStates[o]("Token renewal operation failed due to timeout",null,"Token Renewal Failed",O.Constants.accessToken),n._cacheStorage.setItem(O.Constants.renewStatus+o,O.Constants.tokenRenewStatusCancelled))},this.loadFrameTimeout)},e.prototype.loadFrame=function(t,r){var n=this;this._logger.info("LoadFrame: "+r);var o=r;setTimeout(function(){var e=n.addAdalFrame(o);""!==e.src&&"about:blank"!==e.src||(e.src=t,n._logger.infoPii("Frame Name : "+r+" Navigated to: "+t))},500)},e.prototype.addAdalFrame=function(e){if(void 0===e)return null;this._logger.info("Add msal frame to document:"+e);var t=document.getElementById(e);if(!t){if(document.createElement&&document.documentElement&&-1===window.navigator.userAgent.indexOf("MSIE 5.0")){var r=document.createElement("iframe");r.setAttribute("id",e),r.style.visibility="hidden",r.style.position="absolute",r.style.width=r.style.height="0",r.style.border="0",t=document.getElementsByTagName("body")[0].appendChild(r)}else document.body&&document.body.insertAdjacentHTML&&document.body.insertAdjacentHTML("beforeend","<iframe name='"+e+"' id='"+e+"' style='display:none'></iframe>");window.frames&&window.frames[e]&&(t=window.frames[e])}return t},e.prototype.renewToken=function(e,t,r,n,o,i){var s=e.join(" ").toLowerCase();this._logger.verbose("renewToken is called for scope:"+s);var a,c=this.addAdalFrame("msalRenewFrame"+s);i&&(o.extraQueryParameters=i),a=n?O.Constants.acquireTokenUser+O.Constants.resourceDelimeter+n.userIdentifier+O.Constants.resourceDelimeter+o.state:O.Constants.acquireTokenUser+O.Constants.resourceDelimeter+O.Constants.no_user+O.Constants.resourceDelimeter+o.state,w.Utils.isEmpty(this._cacheStorage.getItem(a))&&this._cacheStorage.setItem(a,JSON.stringify(n));var u=O.Constants.authority+O.Constants.resourceDelimeter+o.state;w.Utils.isEmpty(this._cacheStorage.getItem(u))&&this._cacheStorage.setItem(u,o.authority),this._cacheStorage.setItem(O.Constants.nonceIdToken,o.nonce),this._logger.verbose("Renew token Expected state: "+o.state);var l=o.createNavigateUrl(e)+O.Constants.prompt_none;l=this.addHintParameters(l,n),window.renewStates.push(o.state),window.requestType=O.Constants.renewToken,this.registerCallback(o.state,s,t,r),this._logger.infoPii("Navigate to:"+l),c.src="about:blank",this.loadIframeTimeout(l,"msalRenewFrame"+s,s)},e.prototype.renewIdToken=function(e,t,r,n,o,i){e.join(" ").toLowerCase();this._logger.info("renewidToken is called");var s,a=this.addAdalFrame("msalIdTokenFrame");i&&(o.extraQueryParameters=i),s=n?O.Constants.acquireTokenUser+O.Constants.resourceDelimeter+n.userIdentifier+O.Constants.resourceDelimeter+o.state:O.Constants.acquireTokenUser+O.Constants.resourceDelimeter+O.Constants.no_user+O.Constants.resourceDelimeter+o.state,w.Utils.isEmpty(this._cacheStorage.getItem(s))&&this._cacheStorage.setItem(s,JSON.stringify(n));var c=O.Constants.authority+O.Constants.resourceDelimeter+o.state;w.Utils.isEmpty(this._cacheStorage.getItem(c))&&this._cacheStorage.setItem(c,o.authority),this._cacheStorage.setItem(O.Constants.nonceIdToken,o.nonce),this._logger.verbose("Renew Idtoken Expected state: "+o.state);var u=o.createNavigateUrl(e)+O.Constants.prompt_none;u=this.addHintParameters(u,n),window.renewStates.push(o.state),window.requestType=O.Constants.renewToken,this.registerCallback(o.state,this.clientId,t,r),this._logger.infoPii("Navigate to:"+u),a.src="about:blank",this.loadIframeTimeout(u,"msalIdTokenFrame",this.clientId)},e.prototype.getUser=function(){if(this._user)return this._user;var e=this._cacheStorage.getItem(O.Constants.idTokenKey),t=this._cacheStorage.getItem(O.Constants.msalClientInfo);if(w.Utils.isEmpty(e)||w.Utils.isEmpty(t))return null;var r=new h.IdToken(e),n=new m.ClientInfo(t);return this._user=y.User.createUser(r,n,this.authority),this._user},e.prototype.handleAuthenticationResponse=function(e){null==e&&(e=window.location.hash);var t=null,r=!1,n=!1;try{n=window.opener&&window.opener.msal&&window.opener.msal!==window.msal}catch(e){n=!1}n?(t=window.opener.msal,r=!0):window.parent&&window.parent.msal&&(t=window.parent.msal);var o,i=t.getRequestInfo(e),s=null,a=null;if(t._logger.info("Returned from redirect url"),window.parent!==window&&window.parent.msal)a=window.parent.callBackMappedToRenewStates[i.stateResponse];else if(n)a=window.opener.callBackMappedToRenewStates[i.stateResponse];else{if(t._navigateToLoginRequestUrl)return a=null,t._cacheStorage.setItem(O.Constants.urlHash,e),!1,void(window.parent!==window||r||(window.location.href=t._cacheStorage.getItem(O.Constants.loginRequest,this.storeAuthStateInCookie)));a=t._tokenReceivedCallback,window.location.hash=""}t.saveTokenFromHash(i),i.requestType===O.Constants.renewToken&&window.parent?(window.parent!==window?t._logger.verbose("Window is in iframe, acquiring token silently"):t._logger.verbose("acquiring token interactive in progress"),s=i.parameters[O.Constants.accessToken]||i.parameters[O.Constants.idToken],o=O.Constants.accessToken):i.requestType===O.Constants.login&&(s=i.parameters[O.Constants.idToken],o=O.Constants.idToken);var c=i.parameters[O.Constants.errorDescription],u=i.parameters[O.Constants.error];try{a&&a.call(t,c,s,u,o,this.getUserState(this._cacheStorage.getItem(O.Constants.stateLogin,this.storeAuthStateInCookie)))}catch(e){t._logger.error("Error occurred in token received callback function: "+e)}if(n)for(var l=0;l<window.opener.openedWindows.length;l++)window.opener.openedWindows[l].close()},e.prototype.saveAccessToken=function(e,t,r,n,o){var i,s=new m.ClientInfo(n);if(t.parameters.hasOwnProperty("scope")){for(var a=(i=t.parameters.scope).split(" "),c=this._cacheStorage.getAllAccessTokens(this.clientId,e),u=0;u<c.length;u++){var l=c[u];if(l.key.userIdentifier===r.userIdentifier){var d=l.key.scopes.split(" ");w.Utils.isIntersectingScopes(d,a)&&this._cacheStorage.removeItem(JSON.stringify(l.key))}}var h=new f.AccessTokenKey(e,this.clientId,i,s.uid,s.utid),p=new g.AccessTokenValue(t.parameters[O.Constants.accessToken],o.rawIdToken,w.Utils.expiresIn(t.parameters[O.Constants.expiresIn]).toString(),n);this._cacheStorage.setItem(JSON.stringify(h),JSON.stringify(p))}else{i=this.clientId;h=new f.AccessTokenKey(e,this.clientId,i,s.uid,s.utid),p=new g.AccessTokenValue(t.parameters[O.Constants.idToken],t.parameters[O.Constants.idToken],o.expiration,n);this._cacheStorage.setItem(JSON.stringify(h),JSON.stringify(p))}},e.prototype.saveTokenFromHash=function(e){this._logger.info("State status:"+e.stateMatch+"; Request type:"+e.requestType),this._cacheStorage.setItem(O.Constants.msalError,""),this._cacheStorage.setItem(O.Constants.msalErrorDescription,"");var t="",r="";if(e.parameters.hasOwnProperty("scope")?e.parameters.scope.toLowerCase():this.clientId,e.parameters.hasOwnProperty(O.Constants.errorDescription)||e.parameters.hasOwnProperty(O.Constants.error)){var n="error";if(this._logger.infoPii("Error :"+e.parameters[O.Constants.error]+"; Error description:"+e.parameters[O.Constants.errorDescription]),this._cacheStorage.setItem(O.Constants.msalError,e.parameters[n]),this._cacheStorage.setItem(O.Constants.msalErrorDescription,e.parameters[O.Constants.errorDescription]),e.requestType===O.Constants.login&&(this._loginInProgress=!1,this._cacheStorage.setItem(O.Constants.loginError,e.parameters[O.Constants.errorDescription]+":"+e.parameters[O.Constants.error]),t=O.Constants.authority+O.Constants.resourceDelimeter+e.stateResponse),e.requestType===O.Constants.renewToken){this._acquireTokenInProgress=!1,t=O.Constants.authority+O.Constants.resourceDelimeter+e.stateResponse;var o=null!==this.getUser()?this.getUser().userIdentifier:"";r=O.Constants.acquireTokenUser+O.Constants.resourceDelimeter+o+O.Constants.resourceDelimeter+e.stateResponse}}else if(e.stateMatch){var i;this._logger.info("State is right"),e.parameters.hasOwnProperty(O.Constants.sessionState)&&this._cacheStorage.setItem(O.Constants.msalSessionState,e.parameters[O.Constants.sessionState]);var s="";if(e.parameters.hasOwnProperty(O.Constants.accessToken)){this._logger.info("Fragment has access token"),this._acquireTokenInProgress=!1;var a=void 0;i=e.parameters.hasOwnProperty(O.Constants.idToken)?new h.IdToken(e.parameters[O.Constants.idToken]):new h.IdToken(this._cacheStorage.getItem(O.Constants.idTokenKey)),t=O.Constants.authority+O.Constants.resourceDelimeter+e.stateResponse;var c=void 0;w.Utils.isEmpty(this._cacheStorage.getItem(t))||(c=this._cacheStorage.getItem(t),c=w.Utils.replaceFirstPath(c,i.tenantId)),a=(e.parameters.hasOwnProperty(O.Constants.clientInfo)?s=e.parameters[O.Constants.clientInfo]:this._logger.warning("ClientInfo not received in the response from AAD"),y.User.createUser(i,new m.ClientInfo(s),c)),r=O.Constants.acquireTokenUser+O.Constants.resourceDelimeter+a.userIdentifier+O.Constants.resourceDelimeter+e.stateResponse;var u=O.Constants.acquireTokenUser+O.Constants.resourceDelimeter+O.Constants.no_user+O.Constants.resourceDelimeter+e.stateResponse,l=void 0;w.Utils.isEmpty(this._cacheStorage.getItem(r))?w.Utils.isEmpty(this._cacheStorage.getItem(u))||this.saveAccessToken(c,e,a,s,i):(l=JSON.parse(this._cacheStorage.getItem(r)),a&&l&&w.Utils.compareObjects(a,l)?(this.saveAccessToken(c,e,a,s,i),this._logger.info("The user object received in the response is the same as the one passed in the acquireToken request")):this._logger.warning("The user object created from the response is not the same as the one passed in the acquireToken request"))}if(e.parameters.hasOwnProperty(O.Constants.idToken)){this._logger.info("Fragment has id token"),this._loginInProgress=!1,i=new h.IdToken(e.parameters[O.Constants.idToken]),e.parameters.hasOwnProperty(O.Constants.clientInfo)?s=e.parameters[O.Constants.clientInfo]:this._logger.warning("ClientInfo not received in the response from AAD"),t=O.Constants.authority+O.Constants.resourceDelimeter+e.stateResponse;c=void 0;if(w.Utils.isEmpty(this._cacheStorage.getItem(t))||(c=this._cacheStorage.getItem(t),c=w.Utils.replaceFirstPath(c,i.tenantId)),this._user=y.User.createUser(i,new m.ClientInfo(s),c),i&&i.nonce)i.nonce!==this._cacheStorage.getItem(O.Constants.nonceIdToken,this.storeAuthStateInCookie)?(this._user=null,this._cacheStorage.setItem(O.Constants.loginError,"Nonce Mismatch. Expected Nonce: "+this._cacheStorage.getItem(O.Constants.nonceIdToken)+",Actual Nonce: "+i.nonce),this._logger.error("Nonce Mismatch.Expected Nonce: "+this._cacheStorage.getItem(O.Constants.nonceIdToken)+",Actual Nonce: "+i.nonce)):(this._cacheStorage.setItem(O.Constants.idTokenKey,e.parameters[O.Constants.idToken]),this._cacheStorage.setItem(O.Constants.msalClientInfo,s),this.saveAccessToken(c,e,this._user,s,i));else{t=e.stateResponse,r=e.stateResponse,this._logger.error("Invalid id_token received in the response");n="error";var d="error_description";e.parameters[n]="invalid idToken",e.parameters[d]="Invalid idToken. idToken: "+e.parameters[O.Constants.idToken],this._cacheStorage.setItem(O.Constants.msalError,"invalid idToken"),this._cacheStorage.setItem(O.Constants.msalErrorDescription,"Invalid idToken. idToken: "+e.parameters[O.Constants.idToken])}}}else{t=e.stateResponse,r=e.stateResponse,this._logger.error("State Mismatch.Expected State: "+this._cacheStorage.getItem(O.Constants.stateLogin,this.storeAuthStateInCookie)+",Actual State: "+e.stateResponse);n="error",d="error_description";e.parameters[n]="Invalid_state",e.parameters[d]="Invalid_state. state: "+e.stateResponse,this._cacheStorage.setItem(O.Constants.msalError,"Invalid_state"),this._cacheStorage.setItem(O.Constants.msalErrorDescription,"Invalid_state. state: "+e.stateResponse)}this._cacheStorage.setItem(O.Constants.renewStatus+e.stateResponse,O.Constants.tokenRenewStatusCompleted),this._cacheStorage.removeAcquireTokenEntries(t,r),this._cacheStorage.clearCookie()},e.prototype.isCallback=function(e){e=this.getHash(e);var t=w.Utils.deserialize(e);return t.hasOwnProperty(O.Constants.errorDescription)||t.hasOwnProperty(O.Constants.error)||t.hasOwnProperty(O.Constants.accessToken)||t.hasOwnProperty(O.Constants.idToken)},e.prototype.getHash=function(e){return-1<e.indexOf("#/")?e=e.substring(e.indexOf("#/")+2):-1<e.indexOf("#")&&(e=e.substring(1)),e},e.prototype.getRequestInfo=function(e){e=this.getHash(e);var t=w.Utils.deserialize(e),r=new s.TokenResponse;if(t&&((r.parameters=t).hasOwnProperty(O.Constants.errorDescription)||t.hasOwnProperty(O.Constants.error)||t.hasOwnProperty(O.Constants.accessToken)||t.hasOwnProperty(O.Constants.idToken))){r.valid=!0;var n=void 0;if(!t.hasOwnProperty("state"))return r;if(n=t.state,(r.stateResponse=n)===this._cacheStorage.getItem(O.Constants.stateLogin,this.storeAuthStateInCookie))return r.requestType=O.Constants.login,r.stateMatch=!0,r;if(n===this._cacheStorage.getItem(O.Constants.stateAcquireToken,this.storeAuthStateInCookie))return r.requestType=O.Constants.renewToken,r.stateMatch=!0,r;if(!r.stateMatch){r.requestType=window.requestType;for(var o=window.renewStates,i=0;i<o.length;i++)if(o[i]===r.stateResponse){r.stateMatch=!0;break}}}return r},e.prototype.getScopeFromState=function(e){if(e){var t=e.indexOf("|");if(-1<t&&t+1<e.length)return e.substring(t+1)}return""},e.prototype.getUserState=function(e){if(e){var t=e.indexOf("|");if(-1<t&&t+1<e.length)return e.substring(t+1)}return""},e.prototype.isInIframe=function(){return window.parent!==window},e.prototype.loginInProgress=function(){return!!this._cacheStorage.getItem(O.Constants.urlHash)||this._loginInProgress},e.prototype.getHostFromUri=function(e){var t=String(e).replace(/^(https?:)\/\//,"");return t=t.split("/")[0]},e.prototype.getScopesForEndpoint=function(e){if(0<this._unprotectedResources.length)for(var t=0;t<this._unprotectedResources.length;t++)if(-1<e.indexOf(this._unprotectedResources[t]))return null;if(0<this._protectedResourceMap.size)for(var r=0,n=Array.from(this._protectedResourceMap.keys());r<n.length;r++){var o=n[r];if(-1<e.indexOf(o))return this._protectedResourceMap.get(o)}return-1<e.indexOf("http://")||-1<e.indexOf("https://")?this.getHostFromUri(e)===this.getHostFromUri(this._redirectUri)?new Array(this.clientId):null:new Array(this.clientId)},e.prototype.setloginInProgress=function(e){this._loginInProgress=e},e.prototype.getAcquireTokenInProgress=function(){return this._acquireTokenInProgress},e.prototype.setAcquireTokenInProgress=function(e){this._acquireTokenInProgress=e},e.prototype.getLogger=function(){return this._logger},n.__decorate([o],e.prototype,"acquireTokenSilent",null),e}();t.UserAgentApplication=i},"./src/Utils.ts":
/*!**********************!*\
  !*** ./src/Utils.ts ***!
  \**********************/
/*! no static exports found */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function a(){}return a.compareObjects=function(e,t){return!(!e||!t)&&!(!e.userIdentifier||!t.userIdentifier||e.userIdentifier!==t.userIdentifier)},a.expiresIn=function(e){return e||(e="3599"),this.now()+parseInt(e,10)},a.now=function(){return Math.round((new Date).getTime()/1e3)},a.isEmpty=function(e){return void 0===e||!e||0===e.length},a.extractIdToken=function(e){var t=this.decodeJwt(e);if(!t)return null;try{var r=t.JWSPayload,n=this.base64DecodeStringUrlSafe(r);return n?JSON.parse(n):null}catch(e){}return null},a.base64EncodeStringUrlSafe=function(e){return window.btoa?window.btoa(e):this.encode(e)},a.base64DecodeStringUrlSafe=function(e){return e=e.replace(/-/g,"+").replace(/_/g,"/"),window.atob?decodeURIComponent(encodeURIComponent(window.atob(e))):decodeURIComponent(encodeURIComponent(this.decode(e)))},a.encode=function(e){var t,r,n,o,i,s,a,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",u="",l=0;for(e=this.utf8Encode(e);l<e.length;)o=(t=e.charCodeAt(l++))>>2,i=(3&t)<<4|(r=e.charCodeAt(l++))>>4,s=(15&r)<<2|(n=e.charCodeAt(l++))>>6,a=63&n,isNaN(r)?s=a=64:isNaN(n)&&(a=64),u=u+c.charAt(o)+c.charAt(i)+c.charAt(s)+c.charAt(a);return u.replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")},a.utf8Encode=function(e){e=e.replace(/\r\n/g,"\n");for(var t="",r=0;r<e.length;r++){var n=e.charCodeAt(r);n<128?t+=String.fromCharCode(n):(127<n&&n<2048?t+=String.fromCharCode(n>>6|192):(t+=String.fromCharCode(n>>12|224),t+=String.fromCharCode(n>>6&63|128)),t+=String.fromCharCode(63&n|128))}return t},a.decode=function(e){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",r=(e=String(e).replace(/=+$/,"")).length;if(r%4==1)throw new Error("The token to be decoded is not correctly encoded.");for(var n,o,i,s,a,c,u,l,d="",h=0;h<r;h+=4){if(n=t.indexOf(e.charAt(h)),o=t.indexOf(e.charAt(h+1)),i=t.indexOf(e.charAt(h+2)),s=t.indexOf(e.charAt(h+3)),h+2===r-1){c=(a=n<<18|o<<12|i<<6)>>16&255,u=a>>8&255,d+=String.fromCharCode(c,u);break}if(h+1===r-1){c=(a=n<<18|o<<12)>>16&255,d+=String.fromCharCode(c);break}c=(a=n<<18|o<<12|i<<6|s)>>16&255,u=a>>8&255,l=255&a,d+=String.fromCharCode(c,u,l)}return d},a.decodeJwt=function(e){if(this.isEmpty(e))return null;var t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);return!t||t.length<4?null:{header:t[1],JWSPayload:t[2],JWSSig:t[3]}},a.deserialize=function(e){var t,r=/\+/g,n=/([^&=]+)=([^&]*)/g,o=function(e){return decodeURIComponent(e.replace(r," "))},i={};for(t=n.exec(e);t;)i[o(t[1])]=o(t[2]),t=n.exec(e);return i},a.isIntersectingScopes=function(e,t){e=this.convertToLowerCase(e);for(var r=0;r<t.length;r++)if(-1<e.indexOf(t[r].toLowerCase()))return!0;return!1},a.containsScope=function(t,e){return t=this.convertToLowerCase(t),e.every(function(e){return 0<=t.indexOf(e.toString().toLowerCase())})},a.convertToLowerCase=function(e){return e.map(function(e){return e.toLowerCase()})},a.removeElement=function(e,t){return e.filter(function(e){return e!==t})},a.decimalToHex=function(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t},a.getLibraryVersion=function(){return"0.2.3"},a.replaceFirstPath=function(e,t){if(e.match(/^(https?\:)\/\/(([^:\/?#] *)(?:\:([0-9]+))?)([\/]{0,1}[^?#] *)(\?[^#] *|)(#. *|)$/)){var r=a.GetUrlComponents(e),n=r.PathSegments;n.shift(),(n[0]&&"common"===n[0]||"organizations"===n[0])&&(n[0]=t,e=r.Protocol+"//"+r.HostNameAndPort+"/"+n.join("/"))}return e},a.createNewGuid=function(){var e=window.crypto;if(e&&e.getRandomValues){var t=new Uint8Array(16);return e.getRandomValues(t),t[6]|=64,t[6]&=79,t[8]|=128,t[8]&=191,a.decimalToHex(t[0])+a.decimalToHex(t[1])+a.decimalToHex(t[2])+a.decimalToHex(t[3])+"-"+a.decimalToHex(t[4])+a.decimalToHex(t[5])+"-"+a.decimalToHex(t[6])+a.decimalToHex(t[7])+"-"+a.decimalToHex(t[8])+a.decimalToHex(t[9])+"-"+a.decimalToHex(t[10])+a.decimalToHex(t[11])+a.decimalToHex(t[12])+a.decimalToHex(t[13])+a.decimalToHex(t[14])+a.decimalToHex(t[15])}for(var r="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",n="0123456789abcdef",o=0,i="",s=0;s<36;s++)"-"!==r[s]&&"4"!==r[s]&&(o=16*Math.random()|0),"x"===r[s]?i+=n[o]:"y"===r[s]?(o&=3,i+=n[o|=8]):i+=r[s];return i},a.GetUrlComponents=function(e){if(!e)throw"Url required";var t=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),r=e.match(t);if(!r||r.length<6)throw"Valid url required";var n={Protocol:r[1],HostNameAndPort:r[4],AbsolutePath:r[5]},o=n.AbsolutePath.split("/");return o=o.filter(function(e){return e&&0<e.length}),n.PathSegments=o,n},a.CanonicalizeUri=function(e){return e&&(e=e.toLowerCase()),e&&!a.endsWith(e,"/")&&(e+="/"),e},a.endsWith=function(e,t){return!(!e||!t)&&-1!==e.indexOf(t,e.length-t.length)},a}();t.Utils=n},"./src/XHRClient.ts":
/*!**************************!*\
  !*** ./src/XHRClient.ts ***!
  \**************************/
/*! no static exports found */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.prototype.sendRequestAsync=function(e,t,r){var i=this;return new Promise(function(r,n){var o=new XMLHttpRequest;if(o.open(t,e,!0),o.onload=function(e){(o.status<200||300<=o.status)&&n(i.handleError(o.responseText));try{var t=JSON.parse(o.responseText)}catch(e){n(i.handleError(o.responseText))}r(t)},o.onerror=function(e){n(o.status)},"GET"!==t)throw"not implemented";o.send()})},e.prototype.handleError=function(t){var e;try{if((e=JSON.parse(t)).error)return e.error;throw t}catch(e){return t}},e}();t.XhrClient=n},"./src/index.ts":
/*!**********************!*\
  !*** ./src/index.ts ***!
  \**********************/
/*! no static exports found */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(/*! ./UserAgentApplication */"./src/UserAgentApplication.ts");t.UserAgentApplication=n.UserAgentApplication;var o=r(/*! ./Logger */"./src/Logger.ts");t.Logger=o.Logger;var i=r(/*! ./Logger */"./src/Logger.ts");t.LogLevel=i.LogLevel;var s=r(/*! ./User */"./src/User.ts");t.User=s.User;var a=r(/*! ./Constants */"./src/Constants.ts");t.Constants=a.Constants;var c=r(/*! ./RequestInfo */"./src/RequestInfo.ts");t.TokenResponse=c.TokenResponse;var u=r(/*! ./Authority */"./src/Authority.ts");t.Authority=u.Authority},0:
/*!****************************!*\
  !*** multi ./src/index.ts ***!
  \****************************/
/*! no static exports found */function(e,t,r){e.exports=r(/*! D:\Projects\code\microsoft-authentication-library-for-js\lib\msal-angular\samples\MSALAngularDemoApp\node_modules\@azure\msal-angular\node_modules\msal\src\index.ts */"./src/index.ts")}})});
//# sourceMappingURL=msal.min.js.map